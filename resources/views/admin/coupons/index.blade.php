{{-- resources/views/admin/coupons/index.blade.php --}}\n@extends('layouts.admin')\n\n@section('title', 'Kupony rabatowe')\n\n@push('styles')\n<style>\n    .coupon-card {\n        background: white;\n        border: 1px solid var(--border);\n        border-radius: 12px;\n        padding: 1.5rem;\n        margin-bottom: 1rem;\n        display: grid;\n        grid-template-columns: auto 1fr auto auto;\n        gap: 1.5rem;\n        align-items: center;\n        transition: all 0.2s;\n    }\n\n    .coupon-card:hover {\n        box-shadow: 0 4px 12px rgba(0,0,0,0.08);\n    }\n\n    .coupon-code {\n        font-family: 'Courier New', monospace;\n        font-size: 1.5rem;\n        font-weight: 700;\n        background: linear-gradient(135deg, var(--primary), var(--secondary));\n        background-clip: text;\n        -webkit-background-clip: text;\n        -webkit-text-fill-color: transparent;\n        padding: 0.5rem 1rem;\n        background-color: var(--light-gray);\n        border-radius: 8px;\n        border: 2px dashed var(--border);\n    }\n\n    .coupon-details h4 {\n        font-weight: 600;\n        margin-bottom: 0.5rem;\n    }\n\n    .coupon-meta {\n        display: flex;\n        gap: 1rem;\n        font-size: 0.875rem;\n        color: var(--gray);\n    }\n\n    .coupon-stats {\n        text-align: center;\n        padding: 0.75rem 1.25rem;\n        background: var(--light-gray);\n        border-radius: 10px;\n    }\n\n    .coupon-stats strong {\n        display: block;\n        font-size: 1.25rem;\n        font-weight: 700;\n        margin-bottom: 0.25rem;\n    }\n\n    .coupon-stats span {\n        font-size: 0.75rem;\n        color: var(--gray);\n    }\n</style>\n@endpush\n\n@section('content')\n<div class="page-header">\n    <div class="breadcrumb">\n        <a href="{{ route('admin.dashboard') }}">Admin</a>\n        <span>/</span>\n        <span>Kupony</span>\n    </div>\n    <h1 class="page-title">Kupony rabatowe</h1>\n    <p class="page-subtitle">Zarządzaj kodami promocyjnymi</p>\n</div>\n\n<!-- Add Coupon Form -->\n<div class="form-card" style="margin-bottom: 2rem;">\n    <h3 class="section-title">Utwórz nowy kupon</h3>\n    \n    <form method="POST" action="{{ route('admin.coupons.store') }}">\n        @csrf\n        \n        <div class="form-row">\n            <div class="form-group">\n                <label class="form-label required">Kod kuponu</label>\n                <input type="text" name="code" class="form-input @error('code') error @enderror"  \n                       value="{{ old('code') }}" placeholder="WELCOME10" style="text-transform: uppercase;" required>\n                @error('code')\n                    <div class="error-message"><i class="fas fa-exclamation-circle"></i> {{ $message }}</div>\n                @enderror\n                <div class="form-help">Kod musi być unikalny, bez spacji</div>\n            </div>\n\n            <div class="form-group">\n                <label class="form-label required">Typ rabatu</label>\n                <select name="type" class="form-select" required>\n                    <option value="percentage">Procent (%)</option>\n                    <option value="fixed">Kwota (PLN)</option>\n                </select>\n            </div>\n        </div>\n\n        <div class="form-row">\n            <div class="form-group">\n                <label class="form-label required">Wartość rabatu</label>\n                <input type="number" name="value" class="form-input"  \n                       value="{{ old('value') }}" step="0.01" min="0" placeholder="10" required>\n                <div class="form-help">Np. 10 (dla 10% lub 10 zł)</div>\n            </div>\n\n            <div class="form-group">\n                <label class="form-label">Minimalna wartość zamówienia</label>\n                <div class="input-group">\n                    <input type="number" name="min_order_value" class="form-input"  \n                           value="{{ old('min_order_value') }}" step="0.01" min="0" placeholder="0">\n                    <span class="input-addon">PLN</span>\n                </div>\n            </div>\n        </div>\n\n        <div class="form-row">\n            <div class="form-group">\n                <label class="form-label">Limit użyć</label>\n                <input type="number" name="usage_limit" class="form-input"  \n                       value="{{ old('usage_limit') }}" min="1" placeholder="Bez limitu">\n                <div class="form-help">Zostaw puste dla nielimitowanego</div>\n            </div>\n\n            <div class="form-group">\n                <label class="form-label">Ważny od</label>\n                <input type="datetime-local" name="valid_from" class="form-input"  \n                       value="{{ old('valid_from') }}">\n            </div>\n        </div>\n\n        <div class="form-row">\n            <div class="form-group">\n                <label class="form-label">Ważny do</label>\n                <input type="datetime-local" name="valid_until" class="form-input"  \n                       value="{{ old('valid_until') }}">\n            </div>\n\n            <div class="form-group">\n                <label class="form-label">&nbsp;</label>\n                <div class="checkbox-group">\n                    <input type="checkbox" name="is_active" id="new_is_active" value="1" checked>\n                    <label for="new_is_active">Aktywny</label>\n                </div>\n            </div>\n        </div>\n\n        <div style="display: flex; justify-content: flex-end;">\n            <button type="submit" class="btn btn-primary">\n                <i class="fas fa-plus"></i> Utwórz kupon\n            </button>\n        </div>\n    </form>\n</div>\n\n<!-- Coupons List -->\n@forelse($coupons ?? [] as $coupon)\n<div class="coupon-card">\n    <div class="coupon-code">{{ $coupon->code }}</div>\n\n    <div class="coupon-details">\n        <h4>\n            {{ $coupon->type == 'percentage' ? $coupon->value . '%' : $coupon->value . ' zł' }} rabatu\n            @if($coupon->min_order_value)\n                • Min. {{ $coupon->min_order_value }} zł\n            @endif\n        </h4>\n        <div class="coupon-meta">\n            @if($coupon->valid_from)\n                <span><i class="fas fa-calendar-alt"></i> Od: {{ $coupon->valid_from->format('d.m.Y') }}</span>\n            @endif\n            @if($coupon->valid_until)\n                <span><i class="fas fa-calendar-times"></i> Do: {{ $coupon->valid_until->format('d.m.Y') }}</span>\n            @endif\n        </div>\n    </div>\n\n    <div class="coupon-stats">\n        <strong>{{ $coupon->usage_count }}/{{ $coupon->usage_limit ?? '∞' }}</strong>\n        <span>użyć</span>\n    </div>\n\n    <div class="action-btns">\n        <button onclick="editCoupon({{ $coupon->id }}, {{ json_encode($coupon) }})"  \n                class="action-btn edit" title="Edytuj">\n            <i class="fas fa-edit"></i>\n        </button>\n        \n        <form method="POST" action="{{ route('admin.coupons.destroy', $coupon) }}" style="margin: 0;"  \n              onsubmit="return confirm('Czy na pewno chcesz usunąć ten kupon?')">\n            @csrf\n            @method('DELETE')\n            <button type="submit" class="action-btn delete" title="Usuń">\n                <i class="fas fa-trash"></i>\n            </button>\n        </form>\n\n        <span class="badge {{ $coupon->is_active ? 'badge-success' : 'badge-danger' }}">\n            {{ $coupon->is_active ? 'Aktywny' : 'Nieaktywny' }}\n        </span>\n    </div>\n</div>\n@empty\n<div class="empty-state" style="background: white; padding: 3rem; border-radius: 16px;">\n    <i class="fas fa-ticket-alt"></i>\n    <h3>Brak kuponów</h3>\n    <p>Utwórz pierwszy kupon rabatowy używając formularza powyżej</p>\n</div>\n@endforelse\n\n<!-- Edit Coupon Modal -->\n<div id="editCouponModal" class="modal">\n    <div class="modal-content" style="max-width: 600px;">\n        <div class="modal-header">\n            <h3 class="modal-title">Edytuj kupon</h3>\n            <button class="modal-close" onclick="closeEditCouponModal()">\n                <i class="fas fa-times"></i>\n            </button>\n        </div>\n        <form id="editCouponForm" method="POST">\n            @csrf\n            @method('PUT')\n            <div class="modal-body">\n                <div class="form-group">\n                    <label class="form-label">Kod kuponu</label>\n                    <input type="text" class="form-input" id="edit_coupon_code" readonly style="background: var(--light-gray);">\n                </div>\n\n                <div class="form-row">\n                    <div class="form-group">\n                        <label class="form-label">Typ</label>\n                        <select name="type" id="edit_type" class="form-select">\n                            <option value="percentage">Procent (%)</option>\n                            <option value="fixed">Kwota (PLN)</option>\n                        </select>\n                    </div>\n\n                    <div class="form-group">\n                        <label class="form-label">Wartość</label>\n                        <input type="number" name="value" id="edit_value" class="form-input" step="0.01" required>\n                    </div>\n                </div>\n\n                <div class="form-group">\n                    <label class="form-label">Min. wartość zamówienia</label>\n                    <input type="number" name="min_order_value" id="edit_min_order_value" class="form-input" step="0.01">\n                </div>\n\n                <div class="form-group">\n                    <div class="checkbox-group">\n                        <input type="checkbox" name="is_active" id="edit_coupon_is_active" value="1">\n                        <label for="edit_coupon_is_active">Aktywny</label>\n                    </div>\n                </div>\n            </div>\n            <div class="modal-footer">\n                <button type="button" class="btn btn-secondary" onclick="closeEditCouponModal()">Anuluj</button>\n                <button type="submit" class="btn btn-primary">\n                    <i class="fas fa-save"></i> Zapisz\n                </button>\n            </div>\n        </form>\n    </div>\n</div>\n\n@push('scripts')\n<script>\n    function editCoupon(id, coupon) {\n        document.getElementById('edit_coupon_code').value = coupon.code;\n        document.getElementById('edit_type').value = coupon.type;\n        document.getElementById('edit_value').value = coupon.value;\n        document.getElementById('edit_min_order_value').value = coupon.min_order_value || '';\n        document.getElementById('edit_coupon_is_active').checked = coupon.is_active;\n        document.getElementById('editCouponForm').action = `/admin/coupons/${id}`;\n        document.getElementById('editCouponModal').classList.add('active');\n    }\n\n    function closeEditCouponModal() {\n        document.getElementById('editCouponModal').classList.remove('active');\n    }\n\n    document.getElementById('editCouponModal').addEventListener('click', function(e) {\n        if (e.target === this) closeEditCouponModal();\n    });\n</script>\n@endpush\n@endsection